<!DOCTYPE html>
<html>
<!--
#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
# 
# http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#  KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
-->
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name = "format-detection" content = "telephone=no"/>
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width;" />
        <link rel="stylesheet" type="text/css" href="css/jquery-mobile.css" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />


        <title>Gozintas</title>
        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="js/partial.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.2.0.js"></script>
        <script type="text/javascript" src="cordova-2.0.0.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/gozintas.js"></script>
        <script type="text/javascript">
            app.initialize();
        </script>
    </head>
    <body>
        <div data-role="page" id="one" data-routing="page1.html">
        </div>

        <div data-role="page" id="two" data-add-back-btn="true" data-routing="page2.html">
            <script> 
                $("#two").live(
                    "pagebeforeshow",
                    function () {
                        gozintas.showSplitTipButtons();
                    }
                );
                $("#two").live(
                    "pageshow",
                    function() {
                    $("#two #total_amount_input").focusout(function() {
                        var isValid = gozintas.validatePrice($(this).val());
                        if(isValid == true){
                            gozintas.storeFoodAmount(parseFloat($(this).val()).toFixed(2));
                        }else{
                            $(this).val("");
                        }
                    });
                    $("#two #total_tax_amount_input").focusout(function(){
                        var isValid = gozintas.validatePrice($(this).val());
                        if(isValid == true){
                            gozintas.storeTaxAmount(parseFloat($(this).val()).toFixed(2));
                        }else{
                            $(this).val("");
                        }
                    })
                });

            </script>        
        </div>

        <div data-role="page" id="three" data-add-back-btn="true" data-routing="page3.html">
            <script>
                $(".group_nickname").live('keyup',function(){
                    group = $(this).parent().parent().parent().attr("class").split(" ")[0]
                    parentClass = "."+group+" ";
                    groupNum = group.split("-")[1]
                    textinput = $(parentClass+'.group_nickname').val();
                    elToRemove = $("#three "+parentClass+"h3 span.ui-btn-text");
                    final_elToRemove = $("#five "+parentClass+"h3 span.ui-btn-text");
                    if(final_elToRemove.length == 0){
                        final_elToRemove = $("#five "+parentClass+"h3");
                    }
                    children = elToRemove.children().detach();
                    finalChildren = final_elToRemove.children().detach();
                    elToRemove.html(textinput);
                    final_elToRemove.html(textinput);
                    elToRemove.append(children);
                    final_elToRemove.append(finalChildren);
                });
            </script>
        </div>

        <div data-role="page" id="three-b" data-add-back-btn="true" data-routing="page3b.html">
            <script>
                $("#three-b").live('pageshow',function(){
                    $("#three-b #people_in_party").focusout(function() {
                        gozintas.storePeopleInParty($(this).val());
                    });
                });
            </script>
        </div>

        <div data-role="page" id="four" data-add-back-btn="true" data-routing="page4.html">
            <script> 
                $("#four").live(
                    "pageshow",
                    function () {
                        gozintas.showPageFourButton();
                    }
                );

                $("#four").live(
                    "pageshow",
                    function() {
                    $("#four #tip_rate").focusout(function() {
                        gozintas.storeTipAmount($(this).val());
                    });
                });
            </script> 
        </div>

        <div data-role="page" id="five" data-add-back-btn="true" data-routing="page5.html">
            <script>
                $("#five").live(
                    "pagebeforeshow",
                    function () {
                        $(".page5.total input").val($("#total_amount_input").val())
                        $(".page5.tax input").val($("#total_tax_amount_input").val())
                        if(!gozintas.billModifier.wine){
                            $(".page5.wine_tip").hide();
                            $(".page5.wine").hide();
                        }
                        if(!gozintas.billModifier.reductions){
                            $(".page5.reductions").hide();
                        }
                        if(!gozintas.billModifier.extras){
                            $(".page5.extras").hide();
                        }
                    }
                );
            </script>
        </div>

        <div data-role="page" id="fiveb" data-add-back-btn="true" data-routing="page5b.html">
            <script>
                $("#fiveb").live(
                    "pagebeforeshow",
                    function () {

                        $("#fiveb input#individuals_in_party").val(gozintas.peopleInParty);
                        $("#fiveb input#food_total").val(gozintas.foodAmount);
                        $("#fiveb input#tax_total").val(gozintas.taxAmount);
                        gozintas.showPageFiveButtons();
                        $("#fiveb input#tip_total").val(gozintas.calculateTip()+" ("+gozintas.tipAmount*100+"%)");
                        $("#fiveb input#total").val(gozintas.calculateTotal());
                        $("#fiveb input#tip_individual").val(gozintas.calculateTipIndividual() +" ("+gozintas.tipAmount*100+"%)");
                        $("#fiveb input#total_individual").val(gozintas.calculateTotalIndividual());
                    }
                );
            </script>
        </div>
    </body>
</html>
