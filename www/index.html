<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name = "format-detection" content = "telephone=no"/>
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width;" />
        <link rel="stylesheet" type="text/css" href="css/jquery-mobile.css" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />


        <title>Gozintas</title>
        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.2.0.js"></script>
        <script type="text/javascript" src="cordova-2.2.0.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/Gozintas.js"></script>
        <script type="text/javascript" src="js/page.js"></script>
        <script type="text/javascript" src="js/partial.js"></script>
        <script type="text/javascript">
            app.initialize();
        </script>
    </head>
    <body>
        <div data-role="page" id="one" data-routing="page1.html">
        </div>

        <div data-role="page" id="two" data-add-back-btn="true" data-routing="page2.html" data-pagejs="page2">
            <script> 
                $("#two").live(
                    "pagebeforeshow",
                    function () {
                        Gozintas.showSplitTipButtons();
                    }
                );

            </script>        
        </div>

        <div data-role="page" id="three" data-add-back-btn="true" data-routing="page3.html" data-pagejs="page3">
        </div>

        <div data-role="page" id="three-b" data-add-back-btn="true" data-routing="page3b.html" data-pagejs="page3b">
            <script>
                $("#three-b").live('pageshow',function(){
                    groups.length = 1
                    groups[0] = new Group();
                    $("#three-b #drinks_deserts_etc").val(Gozintas.totalAmount-Gozintas.taxAmount);
                    $("#three-b #people_in_party").focusout(function() {
                        groups[0].peopleInParty = parseFloat($(this).val());
                    });
                });
            </script>
        </div>

        <div data-role="page" id="four" data-add-back-btn="true" data-routing="page4.html" data-pagejs="page4">
            <script> 
                $("#four").live(
                    "pagebeforeshow",
                    function(){
                        Gozintas.showPageFourPercentages();
                        Gozintas.showPageFourButton();
                        $("#four #tip_rate").focusout(function() {
                            Gozintas.tipAmount = parseFloat($(this).val());
                        });
                        $("#four #tax_tip_rate").focusout(function() {
                            Gozintas.taxTipAmount = parseFloat($(this).val());
                        });
                        $("#four #wine_tip_rate").focusout(function() {
                            Gozintas.wineTipAmount = parseFloat($(this).val());
                        });
                        $("#four #carry_tip_rate").focusout(function() {
                            Gozintas.carryTipAmount = parseFloat($(this).val());
                        });
                        $("#four #tax_tip_rate").focusout(function() {
                            Gozintas.taxTipAmount = parseFloat($(this).val());
                        });
                    }
                );
            </script> 
        </div>

        <div data-role="page" id="five" data-add-back-btn="true" data-routing="page5.html" data-pagejs="page5">
            <script>
                $("#five").live(
                    "pagebeforeshow",
                    function () {
                        Gozintas.calculatePeopleInParty()
                        Gozintas.calculateTotalWithoutReduction()
                        Gozintas.totalIndividual = (+Gozintas.totalWithoutReduction/Gozintas.peopleInParty).toFixed(2)
                        Gozintas.totalTaxIndividual = (+Gozintas.taxAmount/Gozintas.peopleInParty).toFixed(2)
                        Gozintas.calculateTaxAndTotal()

                        for(var i=0; i<groups.length; i++){
                            five_foodTotal = (+groups[i].total- +groups[i].taxTotal - +groups[i].foodTotal - groups[i].carryOutTotal - groups[i].wineTotal).toFixed(2)
                            five_tipTotal = ((+five_foodTotal)*Gozintas.tipAmount + +groups[i].foodTotal*Gozintas.tipAmount + +groups[i].carryOutTotal*Gozintas.carryTipAmount + +groups[i].wineTotal*Gozintas.wineTipAmount + +groups[i].taxTotal*Gozintas.taxTipAmount).toFixed(2)
                            five_finalTotal = +groups[i].total + +five_tipTotal;
                            $("#five #group-"+(i+1)+" #individuals_in_party").val(groups[i].peopleInParty)
                            $("#five #group-"+(i+1)+" #total").val(five_finalTotal)
                            $("#five #group-"+(i+1)+" .food_total label").text("Food Total ("+(Gozintas.tipAmount*100).toFixed()+"% tip rate)")
                            $("#five #group-"+(i+1)+" #food_total").val(+five_foodTotal)
                            
                           $("#five #group-"+(i+1)+" #drinks_deserts_amount_container label").text("Drinks/Deserts/Etc ("+(Gozintas.tipAmount*100).toFixed()+"% tip rate)")

                           $("#five #group-"+(i+1)+" #wine_amount_container label").text("Wine ("+(Gozintas.wineTipAmount*100).toFixed()+"% tip rate)")

                           $("#five #group-"+(i+1)+" #carry_out_amount_container label").text("Carry-out for group ("+(Gozintas.carryTipAmount*100).toFixed()+"% tip rate)")
                            $("#five #group-"+(i+1)+" #total_individual").val((+five_finalTotal/+groups[i].peopleInParty).toFixed(2))
                            $("#five #group-"+(i+1)+" .tax_total label").text("Tax for group ("+(Gozintas.taxTipAmount*100).toFixed()+"% tip rate)")
                            $("#five #group-"+(i+1)+" #tax_total").val(+groups[i].taxTotal)
                            
                            $("#five #group-"+(i+1)+" #tip_total").val(five_tipTotal)
                            $("#five #group-"+(i+1)+" #tip_individual").val((five_tipTotal/groups[i].peopleInParty).toFixed(2))
                            if(groups[i].wine){
                                $("#five #group-"+(i+1)+" #wine_amount_container").show()
                                $("#five #group-"+(i+1)+" #wine_amount").val(groups[i].wineTotal)
                            }else{
                                $("#five #group-"+(i+1)+" #wine_amount_container").hide()
                            }
                            if(groups[i].carryout){
                                $("#five #group-"+(i+1)+" #carry_out_amount_container").show()
                                $("#five #group-"+(i+1)+" #carry_out_amount").val(groups[i].carryOutTotal)
                            }else{
                                $("#five #group-"+(i+1)+" #carry_out_amount_container").hide()
                            }
                            if(groups[i].extras){
                                $("#five #group-"+(i+1)+" #drinks_deserts_amount_container").show()
                                $("#five #group-"+(i+1)+" #drinks_deserts_amount").val(groups[i].foodTotal)
                            }else{
                                $("#five #group-"+(i+1)+" #drinks_deserts_amount_container").hide()
                            }
                        }

                        $(".page5.total input").val($("#total_amount_input").val())
                        $(".page5.tax input").val($("#total_tax_amount_input").val())
                        if(!Gozintas.billModifier.wine){
                            $(".page5.wine_tip").hide();
                            $(".page5.wine").hide();
                        }
                        if(!Gozintas.billModifier.reductions){
                            $(".page5.reductions").hide();
                        }
                        if(!Gozintas.billModifier.extras){
                            $(".page5.extras").hide();
                        }
                    }
                );
            </script>
        </div>

        <div data-role="page" id="fiveb" data-add-back-btn="true" data-routing="page5b.html" data-pagejs="page5b">
            <script>
                $("#fiveb").live(
                    "pagebeforeshow",
                    function () {
                        if(Gozintas.billPath == "determine-tip" || (Gozintas.billPath == "split-tip" && Gozintas.splitBy == "individual")){
                            groups[0].foodTotal = +Gozintas.totalAmount - +Gozintas.taxAmount
                        }

                        $("#fiveb input#individuals_in_party").val(groups[0].peopleInParty);
                        $("#fiveb input#food_total").val("$"+groups[0].foodTotal);
                        $("#fiveb input#wine_total").val("$"+groups[0].wineTotal);
                        $("#fiveb input#carryout_total").val("$"+groups[0].carryOutTotal);
                        $("#fiveb .food_total label").text("Food Total ("+(Gozintas.tipAmount*100).toFixed()+"% tip rate)")
                        $("#fiveb .wine_total label").text("Wine Total ("+(Gozintas.wineTipAmount*100).toFixed()+"% tip rate)")
                        $("#fiveb .carryout_total label").text("Carry-out Total ("+(Gozintas.carryTipAmount*100).toFixed()+"% tip rate)")
                        $("#fiveb .tax_total label").text("Tax ("+(Gozintas.taxTipAmount*100).toFixed()+"% tip rate)")
                        $("#fiveb input#tax_total").val("$"+Gozintas.taxAmount);
                        Gozintas.showPageFiveInputs();
                        $("#fiveb input#tip_total").val("$"+Gozintas.calculateTip());
                        $("#fiveb input#total").val("$"+Gozintas.calculateTotal());
                        $("#fiveb input#tip_individual").val("$"+Gozintas.calculateTipIndividual());
                        $("#fiveb input#total_individual").val("$"+Gozintas.calculateTotalIndividual());
                    }
                );
            </script>
        </div>
    </body>
</html>
